---
title: "Phenotype description"
author: "by [Yan Holtz](https://github.com/holtzy/) - `r format(Sys.time(), '%d %B %Y')`"
---

  
```{r echo=FALSE}
# Just to add space between the introduction of the document
knitr::asis_output(htmltools::htmlPreserve("<br><br>"))
```


This file is the first part of the vitamin-D GWAS analysis. What it does:

* Create a Phenotype file with blood pressure + other traits from the whole UKB (**server only**)
* Describe it

```{r, message=FALSE, warning=FALSE}
# We will need a few library to run this document
library(tidyverse)
library(rmarkdown)    # You need this library to run this template.
library(epuRate)      # Install with devtools: install_github("holtzy/epuRate", force=TRUE)
library(xtable)
library(knitr)
```




#- Get blood pressure data
***
The first step is to read the UKB phenotype file and output only a few fields that will interest me. I will keep only:

- individual ids (f.eid, column 1)
- sex (f.31.0.0, column 8)
- height (f.50.0.0, column 22)
- bmi (f.21001.0.0, column 4069)
- Diastolyc blood pressure (f.4079.0.0, column 706)

This work is done on the **Inode server**, the file I get is transfered locally using ssh.
```{r, eval=FALSE}
# good repertory
ssh uqyholtz@inode.qbi.uq.edu.au
cd /ibscratch/wrayvisscher/Yan_Holtz/4_UKB_GWAS/3_BLOOD_GWAS/0_DATA

# Get the good column + repeat the ID + change header to respect plink format
zcat /references/UKBiobank/pheno/download/9280_12505_UKBiobank.tab.gz | awk '{print $1,$1,$8,$22,$4069,$706}' | sed '1 s/^.*$/FID IID f.31.0.0 f.50.0.0 f.21001.0.0 f.4079.0.0/' > pheno.txt
gzip pheno.txt
```

This make me a file with about 500k lines. (~7M). I transfer it locally.
```{r, eval=FALSE}
# Transfert locally
cd /Users/y.holtz/Dropbox/QBI/4_UK_BIOBANK_GWAS_PROJECT/VitaminD-GWAS/0_DATA
scp uqyholtz@inode.qbi.uq.edu.au:/ibscratch/wrayvisscher/Yan_Holtz/4_UKB_GWAS/3_BLOOD_GWAS/0_DATA/pheno.txt.gz .
```

From my local computer I transfert it on the delta cluster where I will run the GWAS.
```{r, eval=FALSE}
# Transfert on Delta
cd /Users/y.holtz/Dropbox/QBI/4_UK_BIOBANK_GWAS_PROJECT/VitaminD-GWAS/0_DATA
scp pheno.txt.gz y.holtz@delta.imb.uq.edu.au:/home/y.holtz/BLOOD_GWAS/0_DATA
```


#- Describe blood pressure  {.tabset .tabset-fade .tabset-pills}
***
```{r}
#Load the file in R
data=read.table("0_DATA/pheno.txt.gz", header=T, sep=" ")
```

##Dimension
```{r}
tot=nrow(data)
blood=nrow(data[which(!is.na(data$f.4079.0.0)),])
```

I have `r tot` people in the UKB.  
Among them `r blood` people have info concerning their blood pressure (`r blood/tot*100` %)


##Distribution
Distribution of the distolic blood pressure:

```{r, warning=FALSE, fig.align="center"}
data %>%
  ggplot( aes(x=f.4079.0.0)) +
    geom_density( fill="skyblue", color="skyblue") +
    xlab("Diastolic blood pressure")
```




